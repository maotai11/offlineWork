<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>離線工作管理系統</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <!-- 導航欄 -->
    <nav class="navbar">
        <h1>📋 工作管理系統</h1>
        <div class="nav-buttons">
            <button class="nav-btn active" data-view="calendar">📅 月曆</button>
            <button class="nav-btn" data-view="worklogs">📝 工作紀錄</button>
            <button class="nav-btn" data-view="checklist">✅ 核對清單</button>
            <button class="nav-btn" data-view="todos">📋 待辦任務</button>
            <button class="export-btn" onclick="exportToPDF()">📄 匯出PDF</button>
        </div>
    </nav>

    <!-- 主要內容區 -->
    <main class="container">
        
        <!-- 月曆視圖 -->
        <section id="calendar-view" class="view-section active">
            <div class="section-header">
                <h2>月曆視圖</h2>
                <div class="calendar-controls">
                    <button onclick="previousMonth()">◀</button>
                    <span id="current-month"></span>
                    <button onclick="nextMonth()">▶</button>
                    <button onclick="goToday()">今天</button>
                </div>
            </div>
            <div id="calendar-grid" class="calendar-grid"></div>
            
            <!-- 當日詳情 -->
            <div id="day-details" class="day-details hidden">
                <h3 id="selected-date"></h3>
                <div class="day-events">
                    <h4>今日事項</h4>
                    <ul id="day-events-list"></ul>
                </div>
                <div class="add-event">
                    <input type="text" id="new-event-input" placeholder="新增事項...">
                    <button onclick="addCalendarEvent()">新增</button>
                </div>
            </div>
        </section>

        <!-- 工作紀錄 -->
        <section id="worklogs-view" class="view-section">
            <div class="section-header">
                <h2>工作紀錄</h2>
                <button onclick="showAddWorklog()">+ 新增紀錄</button>
            </div>
            
            <div id="worklog-form" class="form-card hidden">
                <h3>新增工作紀錄</h3>
                <input type="date" id="worklog-date" required>
                <input type="text" id="worklog-title" placeholder="工作標題" required>
                <textarea id="worklog-content" placeholder="工作內容詳述..." rows="5"></textarea>
                <input type="text" id="worklog-tags" placeholder="標籤（用逗號分隔）">
                <div class="form-actions">
                    <button onclick="saveWorklog()">儲存</button>
                    <button onclick="cancelWorklog()" class="btn-secondary">取消</button>
                </div>
            </div>

            <div class="filter-bar">
                <input type="text" id="worklog-search" placeholder="搜尋紀錄..." onkeyup="filterWorklogs()">
                <select id="worklog-filter" onchange="filterWorklogs()">
                    <option value="all">全部</option>
                    <option value="today">今天</option>
                    <option value="week">本週</option>
                    <option value="month">本月</option>
                </select>
            </div>

            <div id="worklogs-list" class="list-container"></div>
        </section>

        <!-- 核對清單 -->
        <section id="checklist-view" class="view-section">
            <div class="section-header">
                <h2>核對清單</h2>
                <button onclick="showAddChecklist()">+ 新增清單</button>
            </div>

            <div id="checklist-form" class="form-card hidden">
                <h3>新增核對清單</h3>
                <input type="text" id="checklist-title" placeholder="清單標題" required>
                <textarea id="checklist-items-input" placeholder="輸入項目（每行一項）..." rows="8"></textarea>
                <select id="checklist-repeat">
                    <option value="none">不重複</option>
                    <option value="daily">每日</option>
                    <option value="weekly">每週</option>
                    <option value="monthly">每月</option>
                </select>
                <div class="form-actions">
                    <button onclick="saveChecklist()">儲存</button>
                    <button onclick="cancelChecklist()" class="btn-secondary">取消</button>
                </div>
            </div>

            <div id="checklists-container" class="checklists-container"></div>
        </section>

        <!-- 待辦任務 -->
        <section id="todos-view" class="view-section">
            <div class="section-header">
                <h2>待辦任務</h2>
                <div class="todo-controls">
                    <input type="text" id="new-todo-input" placeholder="新增任務...">
                    <select id="todo-priority">
                        <option value="low">低</option>
                        <option value="medium">中</option>
                        <option value="high">高</option>
                    </select>
                    <input type="date" id="todo-due-date">
                    <button onclick="addTodo()">新增</button>
                </div>
            </div>

            <div class="filter-bar">
                <button class="filter-btn active" data-filter="all" onclick="filterTodos('all')">全部</button>
                <button class="filter-btn" data-filter="active" onclick="filterTodos('active')">進行中</button>
                <button class="filter-btn" data-filter="completed" onclick="filterTodos('completed')">已完成</button>
                <button class="filter-btn" data-filter="high" onclick="filterTodos('high')">高優先</button>
            </div>

            <div id="todos-list" class="todos-list"></div>
            
            <div class="todos-stats">
                <span id="active-count">0</span> 項進行中 · 
                <span id="completed-count">0</span> 項已完成
            </div>
        </section>

    </main>

    <script src="lib/jspdf.umd.min.js"></script>
    <script src="db.js"></script>
    <script src="app.js"></script>
</body>
</html>